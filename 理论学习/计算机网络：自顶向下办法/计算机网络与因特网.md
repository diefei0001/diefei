# 网络构成

>互联网是由多个网络相互连接而成的`网络的网络`,网络的基本构成是[端系统]、[通信链路]、[分组交换机]，彼此通过[通信链路]连接。

- 这是从宏观结构的角度进行概述。交换机接受并转发数据包，常见的有两种：[链路层交换机]和[路由器]

>链路层交换机是服务于局域网内部的`派件员`，路由器是服务于不同网络之间的`转运中心`
-------------------------------------------------------------------------------------------
# 网络结构

## 网络的基本结构
>网络结构可以分为[网络边缘]，[网络核心]，[接入网]三部分。

### 网络边缘与端系统的通信
>网络边缘由端系统构成，边缘系统是网络存在的理由。

>端系统上的网络应用的最常见通信模型是[C/S模式]和[P2P模式]。

- C/S模式最大的[缺点]是`可靠性`和`可拓展性差`，服务器高负载时处理能力会出现[断崖式下降]。
- p2p模式中，[每个节点既是客户端也是服务器]，在文件分发系统中很常用，节点向别的节点索求文件片段，同时也向其他节点提供自己的文件片段，这也是为什么像迅雷这种p2p文件分发系统,下载人数越多，下载速度越快的原因.

>端系统的通信服务有TCP和UDP两种。

- TCP称为`面向连接`的通信服务，所谓面向连接，就是两个端系统通信需要各自做好准备，这过程称为`握手`。TCP第一个特点是[可靠（reliable]*即数据是“原原本本”传递到目的端系统的;另一个特点是有[流量控制]，可以控制发送速率和接收速率;第三个特点是[拥塞控制]，即可以根据通信链路的拥塞情况.
- UDP称为`用户数据报协议`，这种连接方式是`无连接`的，也就是两个端系统通信前并提前不做好准备;UDP另一个特点是`不可靠`，即仅仅“尽全力”保证数据成功传输。

### 网络核心与数据交换技术
>网络核心是由路由器构成的网状系统，其核心功能是为两个处于网络边缘的端系统提供数据的转发和路由。

*路由：决定分组从源到宿的路径* | *转发:通过通信链路将数据进行传递*

>电路交换技术

- 在讨论分组交换技术前，需要了解的是[电路交换技术]，电路交换技术在两个端系统中建立一条宽大的链路，通过`频分多路复用`和`时分多路复用`等方式将链路分为若干线路,每对端系统的通信独享一条线路，这种技术的优点是`通信资源独享`，缺点是`建立连接需要时间`，且如果没有数据传输，资源就会被`浪费`，因此电路交换技术并不适合计算机网络。

>FDM 和 TDM是电路交换技术常用的多路复用技术

[频分复用：将总带宽划分为多个互不重叠的子频段，每个信道独占一个频段，本质是通过频率分割实现多路信号并行传输]
[时分复用：将时间划分为固定长度的时隙，每路信号轮流占用时隙传输，本质是通过时间片轮转实现多路信号分时共享同一信道]

>分组交换技术
- 网络核心实际通过[分组交换技术]实现`转发`和`路由`功能
- [分组交换技术以分组为单位进行存储与转发]。存储-转发，意味着数据首先被分割为小的数据（packet）转发到下一个节点，并等待后续所有分组到达后，再转发到下一跳（hop）。
- [分组交换技术的延迟要比线路交换高].因为每个节点都要等待分组全部到达，才进行下一跳的转发。这个转发方式似乎多此一举，但是其因此具有`共享性`。分组交换技术中，链路不再被分割，在端系统A和B进行通信的时候，连接A和B的一整条链路的每一段，并不是完全占用的，例如：
`                     A————1——————2———————3——————4——————B                                 `
在这一条链路中，假设A和B正在传输数据，因为1节点要等待全部packet到达，因此在这个时间内，仅`A——1`被占用，`1——2`，`2——3`，`3——4`，`4——B`都可以被[共享（sharing）]
- [事实上，分组交换技术也存在缺陷].当链路的输入速率大于输出速率的时候，会出现`排队`和`丢失`，这种情况一般见于多个端系统都需要通过某段链路的情况.当路由器的缓存用完，后续到达的分组将会丢失。

>分组交换网络又可以分为[数据报网络]和[虚电路网络].

- 二者的区别在于是否建立源主机和目标主机的网络层连接。前者每个分组都携带目`标主机的完整地址`，后者携带该`线路的虚电路号`.值得注意的是二者仍然是存储-转发模式，但封装的内容不同。

- 分组交换技术更能`适应网络的突发性`，`共享性更强`，因此能够`允许更多用户接入网络`。在网络大爆炸的今天，分组交换技术即使存在排队，丢失，时延更大的缺点，也是更适合互联网的转发技术。

### 接入网和物理媒体
> 接入网是网络边缘与网络核心连接的中介，常见的接入网有：住宅接入网，企业接入网，无线接入网
*住宅接入网：*
- `DSL模式`，[利用已有电话线网，通过调制解调]接入网络, 通过FDM，互联网和电话网分离。用户通过[连接DSL调制解调器，在splitter中划分频段，在co的数字用户接入复用器（DSLAM）被转换为数字形式]。
- `cable modem`模式，[利用有线电视信号线缆，通过调制解调]接入网络，通过FDM，实现互联网和电视网分离。常见的是HFC模式，[多个家庭通过一根同轴电缆接入光纤节点，再通过光纤接入电缆调制解调器终端接系统（CMTS）。]
- cable和DSL的一个明显区别是，[cable是共享线路，而DSL是独有线路]。
- FTTH模式，可以分为`AON`和`PON`。在PON模式中，[多个ONT（光纤网络端接器）单独一根光纤连接到一个splitter（分配器），最后用一根主干光纤连接到OLT，再接入CO]。FTTH是目前最主流的家庭接入网。
  
*企业接入网*
- `以太网`：多个端系统连接到`交换机`，交换机连接到`路由器`，进而连接到更高层的网络
- `无线LANs` ：无线局域网，在以太网的基础上，通过连接具有`ap功能的路由器`，[实现终端无线接入局域网。]

*无线接入网：*
- `蜂窝移动网络`：通过一个个类似蜂窝的`基站`实现广域的无线网络接入。

> 物理媒体是通信链路的物理实现，连接节点的物理介质,可以分为导引型媒体和非导引型媒体
- [导引型媒体指的是看得见的媒体]，例如`双绞铜线`，`同轴电缆`，`光纤`。[比特在介质内部传输]，而像电磁波等看[不见的媒体，称为非导引型媒体]。
-------------------------------------------------------------------------------------------
# 基于ISP的多层网络
> 端系统通过ISP接入互联网
- ISP称为`网络服务提供商`，我们知道，任意两个端系统都是互连的，因此ISP必然也是互连的。ISP通过部署ISP节点，收取费用供接入网连接。[ISP节点也成为了网络核心的重要组成部分]。
> 多级ISP之间互相连接，形成互联的网络
- ISP全球范围内数量很多，[ISP之间往往合作，互相连接]。ISP可以分为多个层级。 一级ISP`直接连接（称为对等）`或`通过IXP交换数据`，构成BBN；[区域ISP通过Pop接入上层ISP，接入ISP又接入区域ISP]，低层级的ISP可以同时接入多个上层ISP，称为`多宿`
> ICP是特殊的接入网
- ICP称为`网络内容提供商`，例如谷歌，百度等，同样的ICP也要接入ISP的网络。对于全球范围的ICP，接入ISP网络费用高昂，且服务质量一般。因此对于[全球范围服务的ICP，选择自建数据中心与链路，称为CPN]（内容提供商网络）

